package exploit

import "strings"

// XORs 2 slices of bytes
func xorSlices(s1 []byte, s2 []byte) []byte {
	if len(s1) != len(s2) {
		panic("lengths of slices not equal")
	}

	output := make([]byte, len(s1))

	for i := 0; i < len(s1); i++ {
		output[i] = s1[i] ^ s2[i]
	}

	return output
}

func pkcs7Pad(input string, blockLen int) string {
	padding := blockLen - len(input)%blockLen
	return input + strings.Repeat(string(padding), padding)

}

func createXORingFetcher(xorArg []byte) func(byte) {
	pos := len(xorArg) - 1

	return func(input byte) {
		currentStatus.fetchOutputByte(xorArg[pos] ^ input)
		pos--
	}
}
